const CONFIG={BASE_URL:"https://raw.githubusercontent.com/elitemassagemx/Home/main/IMG/",API_URL:"https://raw.githubusercontent.com/elitemassagemx/Home/main/data.json",WHATSAPP_NUMBER:"5215640020305"},CAROUSEL_IMAGE_BASE_URL="https://raw.githubusercontent.com/elitemassagemx/prueba/main/carruimg/",App={state:{services:{},currentCategory:"masajes",initialized:!1},init:async function(){try{const e=await fetch(CONFIG.API_URL);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();this.state.services=t.services,this.renderServices(),this.setupEventListeners(),this.state.initialized=!0,this.loadCarouselContent(),this.setupGallery(),this.setupGalleryAnimations(),document.getElementById("imageModal")&&this.setupGalleryModal(),this.setupFilters()}catch(e){console.error("Error initializing app:",e)}},buildImageUrl:function(e){return e?e.startsWith("http")?e:`${CONFIG.BASE_URL}${e.startsWith("/")?e.slice(1):e}`:`${CONFIG.BASE_URL}default-icon.webp`},handleImageError:function(e){console.warn(`Failed to load image: ${e.src}`),e.src=`${CONFIG.BASE_URL}default-icon.webp`,e.onerror=null},renderServices:function(){const e=document.getElementById("services-grid");if(!e)return;e.innerHTML="";const t=this.state.services[this.state.currentCategory];if(!Array.isArray(t))return void(e.innerHTML="<p>No se encontraron servicios disponibles</p>");const n=document.createDocumentFragment();t.forEach(e=>{const t=this.createServiceElement(e);n.appendChild(t)}),e.appendChild(n),this.renderBenefitsNav(t)},createServiceElement:function(e){const t=document.querySelector("#service-template");if(!t)return document.createElement("div");const n=t.content.cloneNode(!0),r=n.querySelector(".service-icon");return r&&(r.src=this.buildImageUrl(e.icon),r.alt=e.title||"Service icon",r.onerror=()=>this.handleImageError(r)),n.querySelector(".service-title").textContent=e.title||"",n.querySelector(".service-description").textContent=e.description||"",this.populateBenefits(n,e),n.querySelector(".duration-text").textContent=e.duration||"",n},populateBenefits:function(e,t){if(!t.benefits||!t.benefitsIcons)return;const n=e.querySelector(".service-benefits");n.innerHTML="",t.benefits.forEach((e,r)=>{const i=document.createElement("div");i.className="benefit-item";const s=document.createElement("img");s.src=this.buildImageUrl(t.benefitsIcons[r]),s.alt=e,s.className="benefit-icon",s.onerror=()=>this.handleImageError(s);const o=document.createElement("span");o.textContent=e,i.appendChild(s),i.appendChild(o),n.appendChild(i)})},renderBenefitsNav:function(e){const t=document.querySelector(".benefits-nav");if(!t)return;const n=new Set,r=new Map;e.forEach(e=>{e.benefits?.forEach((t,n)=>{r.set(t,e.benefitsIcons[n])}),e.benefits?.forEach(e=>n.add(e))}),t.innerHTML=`<button class="benefit-btn active" data-filter="all"><img src="${this.buildImageUrl("todos.webp")}" alt="Todos" onerror="this.handleImageError(this)"><span>Todos</span></button>${Array.from(n).map(e=>`<button class="benefit-btn" data-filter="${e.toLowerCase().replace(/\s+/g,"-")}"><img src="${this.buildImageUrl(r.get(e))}" alt="${e}" onerror="this.handleImageError(this)"><span>${e}</span></button>`).join("")}`,this.setupBenefitsFilter()},setupBenefitsFilter:function(){document.querySelectorAll(".benefit-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.filter;this.filterServices(t),document.querySelectorAll(".benefit-btn").forEach(e=>e.classList.remove("active")),e.classList.add("active")})})},filterServices:function(e){document.querySelectorAll(".service-item").forEach(t=>{const n="all"===e||Array.from(t.querySelectorAll(".benefit-item span")).some(t=>t.textContent.toLowerCase()===e.replace(/-/g," ").toLowerCase());t.style.display=n?"block":"none"})},setupEventListeners:function(){document.querySelectorAll('.service-category-toggle input[type="radio"]').forEach(e=>{e.addEventListener("change",()=>{this.state.currentCategory=e.value,this.renderServices()})}),document.addEventListener("click",e=>{if(e.target.classList.contains("saber-mas-button")){const t=e.target.closest(".service-item");if(!t)return;const n=Array.from(t.parentNode.children).indexOf(t),r=this.state.services[this.state.currentCategory][n];this.showPopup(r)}}),document.querySelector(".popup .close")?.addEventListener("click",()=>this.hidePopup()),document.querySelector("#whatsapp-button")?.addEventListener("click",()=>{const e=document.querySelector("#popup-title")?.textContent;if(e){const t=`https://wa.me/${CONFIG.WHATSAPP_NUMBER}?text=Hola, me interesa el servicio: ${encodeURIComponent(e)}`;window.open(t,"_blank")}})},showPopup:function(e){const t=document.getElementById("popup");if(!t)return;const n=t.querySelector("#popup-title"),r=t.querySelector("#popup-image"),i=t.querySelector("#popup-description"),s=t.querySelector(".popup-benefits"),o=t.querySelector(".popup-includes"),a=t.querySelector("#popup-duration");if(!n||!r||!i||!s||!o||!a)return;n.textContent=e.title||"",r.src=this.buildImageUrl(e.popupImage||e.image),r.alt=e.title||"",r.onerror=()=>this.handleImageError(r),i.textContent=e.popupDescription||e.description||"",s.innerHTML="",o.innerHTML="",e.benefits&&e.benefitsIcons&&e.benefits.forEach((t,n)=>{const r=document.createElement("div");r.classList.add("popup-benefit-item");const i=document.createElement("img");i.src=this.buildImageUrl(e.benefitsIcons[n]),i.alt=t,i.onerror=()=>this.handleImageError(i);const a=document.createElement("span");a.textContent=t,r.appendChild(i),r.appendChild(a),s.appendChild(r)}),Array.isArray(e.includes)&&e.includes.forEach(e=>{const t=document.createElement("div");t.classList.add("popup-include-item");const n=document.createElement("img");n.src=this.buildImageUrl("check-icon.webp"),n.alt="Incluido",n.onerror=()=>this.handleImageError(n);const r=document.createElement("span");r.textContent=e,t.appendChild(n),t.appendChild(r),o.appendChild(t)}),a.textContent=e.duration||"",t.style.display="block"},hidePopup:function(){const e=document.getElementById("popup");e&&(e.style.display="none")},loadCarouselContent:async function(){try{const e=document.getElementById("carrusel-container");if(!e)return;e.innerHTML='<div class="carousel"><div class="carousel-inner"></div></div><div class="carousel-controls"><button class="carousel-control prev" aria-label="Previous">&lt;</button><button class="carousel-control next" aria-label="Next">&gt;</button></div><div class="carousel-indicators"></div>',await this.initCarousel()}catch(e){console.error("Error loading carousel:",e)}},initCarousel:function(){const e=document.querySelector(".carousel-inner");if(!e)return;const t=["slide1.webp","slide2.webp","slide3.webp","slide4.webp","slide5.webp"];t.forEach(t=>{const n=document.createElement("div");n.className="carousel-item";const r=document.createElement("img");r.src=CAROUSEL_IMAGE_BASE_URL+t,r.alt="Carousel Image",r.loading="lazy",n.appendChild(r),e.appendChild(n)});const n=document.querySelector(".carousel-indicators");t.forEach((e,t)=>{const r=document.createElement("button");r.setAttribute("aria-label",`Slide ${t+1}`),0===t&&(r.classList.add("active"),r.setAttribute("aria-current","true")),n.appendChild(r)});let r=0;const i=t.length,s=document.querySelector(".carousel-control.prev"),o=document.querySelector(".carousel-control.next");function a(t){e.style.transform=`translateX(-${100*t}%)`,r=t,document.querySelectorAll(".carousel-indicators button").forEach((e,n)=>{n===t?(e.classList.add("active"),e.setAttribute("aria-current","true")):(e.classList.remove("active"),e.removeAttribute("aria-current"))})}s&&s.addEventListener("click",()=>{a(r>0?r-1:i-1)}),o&&o.addEventListener("click",()=>{a(r<i-1?r+1:0)}),document.querySelectorAll(".carousel-indicators button").forEach((e,t)=>{e.addEventListener("click",()=>a(t))});const c=setInterval(()=>{a(r<i-1?r+1:0)},5e3);return()=>clearInterval(c)},setupGallery:function(){const e=document.querySelector(".gallery-grid"),t=document.getElementById("ver-mas-galeria");if(!e||!t)return;const n=[{src:"QUESOSAHM.webp",title:"Tabla Gourmet",description:"Después de tu masaje en pareja saborea una exquisita selección de jamón curado, quesos gourmet, fresas cubiertas de chocolate y copas de vino."},{src:"choco2.webp",title:"Chocolate Deluxe",description:"Sumérgete en una experiencia de dulzura y relajación con nuestro tratamiento de chocolate"},{src:"SILLAS.webp",title:"Área de Relajación",description:"Disfruta de nuestro acogedor espacio de relajación antes o después de tu masaje"},{src:"am21.webp",title:"Masaje Relajante",description:"Disfruta de nuestros masajes relajantes con aceites especialmente seleccionados"},{src:"aroma.webp",title:"Aromaterapia",description:"Una experiencia sensorial única con aceites esenciales"},{src:"piedras-calientes-image.webp",title:"Piedras Calientes",description:"Relájate con el calor de nuestras piedras volcánicas"}];n.forEach(t=>{const n=document.createElement("div");n.classList.add("gallery-item"),n.innerHTML=`<img src="${this.buildImageUrl(t.src)}" alt="${t.title}" loading="lazy"><div class="image-overlay"><h3>${t.title}</h3><p>${t.description}</p></div>`,n.addEventListener("click",()=>this.showImageDetails(t)),e.appendChild(n)}),t.addEventListener("click",()=>{window.location.href="galeria.html"})},showImageDetails:function(e){const t=document.getElementById("imageModal");if(!t)return;const n=t.querySelector("img"),r=t.querySelector(".modal-description");n&&r&&(n.src=this.buildImageUrl(e.src),n.alt=e.title,r.innerHTML=`<h3>${e.title}</h3><p>${e.description}</p>`,t.style.display="block")},setupGalleryAnimations:function(){if("undefined"!=typeof gsap&&"undefined"!=typeof ScrollTrigger){const e=gsap.utils.toArray(".gallery-item");e.forEach(e=>{ScrollTrigger.create({trigger:e,start:"top bottom-=100",toggleClass:"fade-in",once:!0})})}},setupGalleryModal:function(){const e=document.getElementById("imageModal");if(!e)return;const t=e.querySelector(".close");t&&(t.onclick=()=>{e.style.display="none"}),window.onclick=t=>{t.target===e&&(e.style.display="none")}},setupFilters:function(){const e=document.querySelectorAll(".benefits-nav button, .package-nav button");e&&e.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.filter;e.closest(".benefits-nav, .package-nav").querySelectorAll("button").forEach(e=>e.classList.remove("active")),e.classList.add("active");const n=e.closest("section").querySelectorAll(".service-item, .package-item");n.forEach(e=>{e.style.display="all"===t||e.classList.contains(t)?"block":"none"})})})}};document.addEventListener("DOMContentLoaded",()=>App.init());
